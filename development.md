# 非原子的线程锁

用两个内核原生互斥锁实现的读写锁，与内核原生读写锁相比，最主要的不同在于加解锁过程没有原子性。

加锁过程中，获得第一把锁之后，获得第二把锁之前，可能会切到另一个线程。你不知道第二把锁将会被读者还是写者抢到，因此此时既不算 RDLOCKED，也不算 WRLOCKED。且此时 tryrdlock 和 trywrlock 都会失败，因此页不算 UNLOCKED 状态。此时这个锁处于三个状态之外的中间状态。
